<?php

class
MageB2B_Sublogin_Block_Admin_System_Config_Form_Fieldset_FormFields
extends
Mage_Adminhtml_Block_System_Config_Form_Fieldset{
protected
$_dummyElement;
protected
$_fieldRenderer;
protected
$_values;
public
function
render(Varien_Data_Form_Element_Abstract
$_8d42409e40e4019fe1ad3970dab02ce54792984f)
{
$_e60edee9bbcec9af2084c09a7e3e3bf5a0643e9f
=
$this->_getHeaderHtml($_8d42409e40e4019fe1ad3970dab02ce54792984f);
$_9334e5a557692b6fa7c28f9c8d94b6aabb7c3662
=
Mage::getModel('sublogin/source_formfields')->getAllOptions();
foreach
(
$_9334e5a557692b6fa7c28f9c8d94b6aabb7c3662
as
$_160e32e46087087b33fde310bcd8834b50529b44){
if
($_160e32e46087087b33fde310bcd8834b50529b44['value']
==
"")
{
continue;
}
$_e60edee9bbcec9af2084c09a7e3e3bf5a0643e9f.=
$this->_getFieldHtml($_8d42409e40e4019fe1ad3970dab02ce54792984f,
$_160e32e46087087b33fde310bcd8834b50529b44);
}
$_e60edee9bbcec9af2084c09a7e3e3bf5a0643e9f
.=
$this->_getFooterHtml($_8d42409e40e4019fe1ad3970dab02ce54792984f);
return
$_e60edee9bbcec9af2084c09a7e3e3bf5a0643e9f;
}

protected
function
_getDummyElement()
{
if
(empty($this->_dummyElement))
{
$this->_dummyElement
=
new
Varien_Object(array('show_in_default'=>1,
'show_in_website'=>1));
}
return
$this->_dummyElement;
}

protected
function
_getFieldRenderer()
{
if
(empty($this->_fieldRenderer))
{
$this->_fieldRenderer
=
Mage::getBlockSingleton('adminhtml/system_config_form_field');
}
return
$this->_fieldRenderer;
}

protected
function
_getValues()
{
if
(empty($this->_values))
{
$this->_values
=
array(
array('label'=>Mage::helper('sublogin')->__('No'),
'value'=>0),
array('label'=>Mage::helper('sublogin')->__('Yes'),
'value'=>1),
);
}
return
$this->_values;
}

protected
function
_getFieldHtml($_64af779d81eb451f44e50893e14780ab31bf8125,
$_160e32e46087087b33fde310bcd8834b50529b44)
{
$_9009690c90c238ad9a965543bc4cdce6aabf503b
=
$this->getConfigData();
$_15c9711f110a61c9f004db7ed2883f24c111d404
=
'sublogin/form_fields_default_values/'.$_160e32e46087087b33fde310bcd8834b50529b44['value'];
if
(isset($_9009690c90c238ad9a965543bc4cdce6aabf503b[$_15c9711f110a61c9f004db7ed2883f24c111d404]))
{
$_461e9bac5c124e13e943d74294b5b3c23e91e59a
=
$_9009690c90c238ad9a965543bc4cdce6aabf503b[$_15c9711f110a61c9f004db7ed2883f24c111d404];
$_37233898c04638c1c267939af8c22b03d1eecf52
=
false;
}
else
{
$_461e9bac5c124e13e943d74294b5b3c23e91e59a
=
"";

$_37233898c04638c1c267939af8c22b03d1eecf52
=
true;
}
$_68dc3926fdadefc4ea3e5e09bf1dd6f6e1785aa5
=
$this->_getDummyElement();
$_fe7f602b170ffc5094f3c885816ac1995dacf4af
=
$this->getFieldType($_160e32e46087087b33fde310bcd8834b50529b44['value']);
$_54323be853e934686a9fca46e2f91c8ead26624e
=
$_64af779d81eb451f44e50893e14780ab31bf8125->addField('sublogin_form_fields_default_values_'.$_160e32e46087087b33fde310bcd8834b50529b44['value'],
$_fe7f602b170ffc5094f3c885816ac1995dacf4af,
array(
'name'
=>
'groups[form_fields_default_values][fields]['.$_160e32e46087087b33fde310bcd8834b50529b44['value'].'][value]',
'label'
=>
$_160e32e46087087b33fde310bcd8834b50529b44['label'],
'value'
=>
$_461e9bac5c124e13e943d74294b5b3c23e91e59a,


'inherit'
=>
$_37233898c04638c1c267939af8c22b03d1eecf52,
'can_use_default_value'
=>
$this->getForm()->canUseDefaultValue($_68dc3926fdadefc4ea3e5e09bf1dd6f6e1785aa5),

'can_use_website_value'
=>
$this->getForm()->canUseWebsiteValue($_68dc3926fdadefc4ea3e5e09bf1dd6f6e1785aa5),

))->setRenderer($this->_getFieldRenderer());
if
($_fe7f602b170ffc5094f3c885816ac1995dacf4af
==
'select')
{
$_54323be853e934686a9fca46e2f91c8ead26624e->setValues(array(
array(
'label'
=>
Mage::helper('sublogin')->__('Yes'),
'value'
=>
1,
),
array(
'label'
=>
Mage::helper('sublogin')->__('No'),
'value'
=>
0,
),
));
}
if
($_160e32e46087087b33fde310bcd8834b50529b44['value']
==
'expire_date')
{
$_e74cf05b2c08941768ee531609600b5495bd1047
=
'<p class="note"><span>'.Mage::helper('sublogin')->__('Format: %s (Year-Month-Date)',
date('Y-m-d')).'</span></p>';
$_54323be853e934686a9fca46e2f91c8ead26624e->setData('after_element_html',
$_e74cf05b2c08941768ee531609600b5495bd1047);
}
if
($_160e32e46087087b33fde310bcd8834b50529b44['value']
==
'acl')
{
$_e74cf05b2c08941768ee531609600b5495bd1047
=
'<p class="note"><span>'.Mage::helper('sublogin')->__('Separate multiple entries by comma. Example: acl_identifier1,acl_identifier2').'</span></p>';
$_54323be853e934686a9fca46e2f91c8ead26624e->setData('after_element_html',
$_e74cf05b2c08941768ee531609600b5495bd1047);
}
return
$_54323be853e934686a9fca46e2f91c8ead26624e->toHtml();
}
protected
function
getFieldType($_54323be853e934686a9fca46e2f91c8ead26624e)
{
switch
($_54323be853e934686a9fca46e2f91c8ead26624e)
{
case
"send_backendmails":
case
"create_sublogins":
case
"is_subscribed":
case
"order_needs_approval":
case
"active":
return
'select';
break;
case
"acl":
return
'textarea';
break;
}
return
'text';
}
}