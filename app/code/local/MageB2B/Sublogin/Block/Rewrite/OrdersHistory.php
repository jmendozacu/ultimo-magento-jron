<?php

class
MageB2B_Sublogin_Block_Rewrite_OrdersHistory
extends
Mage_Sales_Block_Order_History
{
public
function
__construct()
{
parent::__construct();

$this->setTemplate('sublogin/sales/order/history.phtml');
$_3a6c2ec34d8458e049eec354fda76a3e8b1384c1
=
Mage::getResourceModel('sales/order_collection')
->addFieldToSelect('*')
->addFieldToFilter('customer_id',
Mage::getSingleton('customer/session')->getCustomer()->getId())
->addFieldToFilter('state',
array('in'
=>
Mage::getSingleton('sales/order_config')->getVisibleOnFrontStates()));
$_17fe0f58f521a1d8d613a93097a5a22f2074c04f
=
Mage::helper('sublogin')->getCurrentSublogin();
if
(Mage::getStoreConfig('sublogin/general/restrict_order_view')
&&
$_17fe0f58f521a1d8d613a93097a5a22f2074c04f)
{
$_3a6c2ec34d8458e049eec354fda76a3e8b1384c1->addFieldToFilter('customer_email',
Mage::getSingleton('customer/session')->getSubloginEmail());
}
$_3a6c2ec34d8458e049eec354fda76a3e8b1384c1->setOrder('created_at',
'desc');
$this->setOrders($_3a6c2ec34d8458e049eec354fda76a3e8b1384c1);
Mage::app()->getFrontController()->getAction()->getLayout()->getBlock('root')->setHeaderTitle(Mage::helper('sales')->__('My Orders'));
}
}
